webpackJsonp([0],{1e3:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function l(e){return(0,m.createElement)(S.Link,{to:"/author/"+e.author_id,title:"joué "+e.pcount+" fois"},e.author_name+" ["+e.pcount+"]")}function c(e){function t(e,t){return(0,m.createElement)(S.Link,{to:"/play/"+t.play_id},e)}function r(e,t){return(0,m.createElement)(S.Link,{to:"/author/"+t.author_id},e)}var n=e.registers,a={},o=[];return n.forEach(function(e){var t=!0,r=!1,n=void 0;try{for(var o,i=e.plays[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var s=o.value;a[s.play_id]?(a[s.play_id].count++,s.reprise&&(a[s.play_id].reprise=!0),s.firstrun&&(a[s.play_id].firstrun=!0)):(s.count=1,a[s.play_id]=s)}}catch(e){r=!0,n=e}finally{try{!t&&i.return&&i.return()}finally{if(r)throw n}}}),Object.keys(a).forEach(function(e){o.push(a[e])}),(0,m.createElement)(g.Card,{className:(0,w.mdlclass)(12),style:{fontSize:"1em"}},(0,m.createElement)(g.CardTitle,{style:_.STYLES.titleChart},"Tableau des pièces jouées lors de cette saison"),(0,m.createElement)(g.CardText,{style:{margin:"auto",fontSize:"1em"},className:(0,w.mdlclass)(8)},(0,m.createElement)(v.BootstrapTable,{data:o,hover:!0,pagination:!0,options:{sizePerPage:25}},(0,m.createElement)(v.TableHeaderColumn,{dataField:"play_id",isKey:!0,hidden:!0},"ID"),(0,m.createElement)(v.TableHeaderColumn,{dataField:"play_title",width:"20",filter:{type:"TextFilter",placeholder:"Rechercher une pièce",delay:300},dataSort:!0,dataFormat:t},"Pièce"),(0,m.createElement)(v.TableHeaderColumn,{dataField:"play_genre",width:"10",dataSort:!0},"Genre"),(0,m.createElement)(v.TableHeaderColumn,{dataField:"firstrun",dataSort:!0,width:"10",dataFormat:x.checkboxFormatter},"Première"),(0,m.createElement)(v.TableHeaderColumn,{dataField:"reprise",width:"10",dataSort:!0,dataFormat:x.checkboxFormatter},"Reprise"),(0,m.createElement)(v.TableHeaderColumn,{dataField:"author_name",width:"20",filter:{type:"TextFilter",placeholder:"Rechercher un auteur",delay:300},dataSort:!0,dataFormat:r},"Auteur"),(0,m.createElement)(v.TableHeaderColumn,{dataField:"count",width:"20",dataSort:!0},"Nombre de représentations"))))}function u(e){var t=e.registers,r=e.firsts,n=e.reprises,o=t[0],i=t[t.length-1],s=[{label:"Première date",value:o.weekday+" "+(0,x.dateFormatter)(o.date)},{label:"Dernière date",value:i.weekday+" "+(0,x.dateFormatter)(i.date)}];return r.length&&s.push({label:"Premières",value:m.createElement.apply(void 0,["ul",{}].concat(a(r.map(function(e){return(0,m.createElement)("li",{},(0,m.createElement)(S.Link,{to:"/play/"+e.play_id,title:e.play_title+" - "+e.author_name},e.play_title+", le "+(0,x.dateFormatter)(e.firstRunDate)))}))))}),n.length&&s.push({label:"Reprises",value:m.createElement.apply(void 0,["ul",{}].concat(a(n.map(function(e){return(0,m.createElement)("li",{},(0,m.createElement)(S.Link,{to:"/play/"+e.play_id,title:e.play_title+" - "+e.author_name},e.play_title+", le "+(0,x.dateFormatter)(e.repriseDate)))}))))}),(0,m.createElement)("section",{className:"section--center mdl-shadow--2dp",style:{justifyContent:"center",marginBottom:"50px"}},(0,m.createElement)("h2",{style:{textAlign:"center"}},o.season),(0,m.createElement)(g.Card,{className:(0,w.mdlclass)(12),style:{fontSize:"1em"}},(0,m.createElement)(g.CardText,{style:{margin:"auto",fontSize:"1em"}},(0,x.infoprops)(s))),(0,m.createElement)(g.Card,{className:(0,w.mdlclass)(12),style:{fontSize:"1em"}},(0,m.createElement)(g.CardText,{style:{margin:"auto",fontSize:"1em"}},(0,m.createElement)(C.SeasonCalendar,{registers:t}))),(0,m.createElement)(c,{registers:t}))}function p(e){var t={},r=!0,n=!1,a=void 0;try{for(var o,i=e[Symbol.iterator]();!(r=(o=i.next()).done);r=!0){var s=d(o.value,2),l=(s[0],s[1]);void 0===t[l]?t[l]=1:t[l]++}}catch(e){n=!0,a=e}finally{try{!r&&i.return&&i.return()}finally{if(n)throw a}}var c=Object.keys(t).map(function(e){return[e,t[e]]}).sort(function(e,t){return t[1]-e[1]}),u=Number(c[0][0]),p=!1;return e.filter(function(e){var t=d(e,2);t[0];return t[1]!==u||!p&&(p=!0,!0)})}Object.defineProperty(t,"__esModule",{value:!0}),t.ASeasonPrimaryView=t.SeasonPrimaryView=t.SeasonChordDiagram=t.SeasonList=void 0;var d=function(){function e(e,t){var r=[],n=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{!n&&s.return&&s.return()}finally{if(a)throw o}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),f=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),m=r(1),y=r(251),h=r(3),g=(n(h),r(81)),v=r(250),b=r(991),E=n(b),x=r(403),_=r(990),S=r(101),w=r(249),T=r(994),C=r(993);(t.SeasonList=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s(t,e),f(t,[{key:"urlSeasonFormatter",value:function(e,t){var r=t.season;return(0,m.createElement)(S.Link,{to:"/season/"+r},e)}},{key:"render",value:function(){var e=this.props.seasons||[],t={noDataText:"Téléchargement des données ...",sizePerPage:50};return(0,m.createElement)(g.Card,{className:(0,w.mdlclass)({col:8,tablet:12}),style:{fontSize:"1em",margin:"auto",marginTop:"10px"}},(0,m.createElement)(g.CardText,{style:{margin:"auto",fontSize:"1em"}},(0,m.createElement)(v.BootstrapTable,{options:t,data:e,hover:!0,pagination:!0},(0,m.createElement)(v.TableHeaderColumn,{dataField:"id",isKey:!0,hidden:!0},"ID"),(0,m.createElement)(v.TableHeaderColumn,{dataField:"season",dataSort:!0,dataFormat:this.urlSeasonFormatter,width:"15%"},"Saison"),(0,m.createElement)(v.TableHeaderColumn,{dataField:"receipts",dataSort:!0,dataFormat:w.numberWithSpaces,width:"15%"},"Recettes (livres)"),(0,m.createElement)(v.TableHeaderColumn,{dataField:"author1",dataSort:!0,dataFormat:l},"Auteur le plus joué en 1"),(0,m.createElement)(v.TableHeaderColumn,{dataField:"author2",dataSort:!0,dataFormat:l},"Auteur le plus joué en 2"))))}}]),t}(m.Component)).propTypes={seasons:m.PropTypes.array};var A=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s(t,e),f(t,[{key:"componentDidMount",value:function(){var e=this.props.seasonData,t=e.registers,r=e.priceSeries,n={};t.forEach(function(e){n[(0,x.dateFormatter)(e.date)]=e});var o=[{name:"Recettes de la saison "+this.props.seasonLabel,type:"column",yAxis:0,data:t.map(function(e){return[(0,x.dateFormatter)(e.date),e.receipts]})}].concat(a(r.map(function(e){return{name:e.name,step:!0,lineWidth:0,marker:{enabled:!0},data:p(e.data).map(function(e){var t=d(e,2),r=t[0],n=t[1];return[(0,x.dateFormatter)(r),n]}),yAxis:1}})));return new E.default.Chart({chart:{renderTo:"seasonchart",zoomType:"xy"},title:{text:" "},subtitle:{text:"Le prix de référence des places n'est affiché que la première fois. Ensuite, seuls les variations (double, gratuit, etc.) sont affichées",floating:!0,align:"right",verticalAlign:"bottom",x:-80},xAxis:[{type:"category"}],yAxis:[{title:{text:"Recettes (livres)",style:{color:E.default.getOptions().colors[0]}}},{gridLineWidth:0,title:{text:"Prix des places (livres)",style:{color:E.default.getOptions().colors[1]}},opposite:!0}],plotOptions:{series:{cursor:"pointer",point:{events:{click:function(e){y.browserHistory.push((0,S.buildURL)("/register/"+e.point.name))}}}}},tooltip:{shared:!0,formatter:function(){var e=this.points[0].key,t=n[e],r=t.plays.map(function(e){return e.play_title}).join(" - "),a='<span style="font-size: 10px">'+t.weekday+" "+t.date+" - ["+r+"]</span><br/>",o=!0,i=!1,s=void 0;try{for(var l,c=this.points.slice(1)[Symbol.iterator]();!(o=(l=c.next()).done);o=!0){var u=l.value;a+='<br/><span style="color:'+u.series.color+'">●</span>'+u.series.name+": "+u.y+" livres"}}catch(e){i=!0,s=e}finally{try{!o&&c.return&&c.return()}finally{if(i)throw s}}return a}},series:o})}},{key:"render",value:function(){return(0,m.createElement)(g.Card,{className:(0,w.mdlclass)(12)},(0,m.createElement)(g.CardTitle,{style:_.STYLES.titleChart},"Recettes de la saison "+this.props.seasonLabel),(0,m.createElement)(g.CardText,{style:{margin:"auto"}},(0,m.createElement)("div",{id:"seasonchart"})))}}]),t}(m.Component);A.propTypes={seasonLabel:m.PropTypes.string,seasonData:m.PropTypes.object};var P=t.SeasonChordDiagram=function(e){function t(e,r){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r));return n.state={chord:null},n}return s(t,e),f(t,[{key:"componentDidMount",value:function(){var e=this;fetch((0,S.buildURL)("/season/chord-"+this.props.season+".json")).then(function(e){return e.json()}).then(function(t){return e.setState({chord:t})})}},{key:"render",value:function(){return(0,m.createElement)("section",{className:"section--center mdl-shadow--2dp",style:{justifyContent:"center"}},(0,m.createElement)("section",{className:"section--center",style:{marginBottom:"50px"}},(0,m.createElement)(g.Card,{className:(0,w.mdlclass)(12),style:{fontSize:"1em"}},(0,m.createElement)(g.CardTitle,{style:_.STYLES.titleChart},"Répartition des genres sur la saison "+this.props.season),(0,m.createElement)(T.GenreChord,{chord:this.state.chord}))))}}]),t}(m.Component);P.propTypes={season:m.PropTypes.string};!function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}s(t,e),f(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(e){e.data}}])}(m.Component);(t.SeasonPrimaryView=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s(t,e),f(t,[{key:"render",value:function(){if(this.props.loading)return(0,m.createElement)(g.Spinner,{style:{margin:"auto",display:"block"}});var e=this.props.params.id.split("-"),t=d(e,2),r=t[0],n=t[1];r=Number(r),n=Number(n);var a=[];return r>1680&&a.push((0,m.createElement)(S.Link,{to:"/season/"+(r-1)+"-"+(n-1),title:"Saison "+(r-1)+"-"+(n-1)},(0,m.createElement)(g.IconButton,{name:"keyboard_arrow_left",colored:!0}))),a.push(this.props.params.id),n<1793&&a.push((0,m.createElement)(S.Link,{to:"/season/"+(r+1)+"-"+(n+1),title:"Saison "+(r+1)+"-"+(n+1)},(0,m.createElement)(g.IconButton,{name:"keyboard_arrow_right",colored:!0}))),(0,m.createElement)("section",null,m.createElement.apply(void 0,["h2",{style:{textAlign:"center"}}].concat(a)),(0,m.createElement)("div",null,(0,m.createElement)(u,this.props.mainentity)),(0,m.createElement)("div",null,(0,m.createElement)(A,{seasonData:this.props.mainentity,seasonLabel:this.props.params.id})),(0,m.createElement)(P,{season:this.props.params.id}))}}]),t}(m.Component)).propTypes={params:m.PropTypes.object,loading:m.PropTypes.bool,mainentity:m.PropTypes.object};var O=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s(t,e),f(t,[{key:"componentDidMount",value:function(){var e=this.props.seasonData.season,t={};return e.forEach(function(e){t[(0,x.dateFormatter)(e.date)]=e}),new E.default.Chart({chart:{renderTo:"seasonchart",type:"column",zoomType:"x"},title:{text:" "},xAxis:{categories:e.map(function(e){return(0,x.dateFormatter)(e.date)})},yAxis:{title:{text:"Recettes (livres)"}},plotOptions:{series:{cursor:"pointer",point:{events:{click:function(e){y.browserHistory.push((0,S.buildURL)("/play/"+t[e.point.category].play_id))}}}}},series:[{name:"Recettes des pièces de "+this.props.seasonData.author.name+" sur la saison "+this.props.seasonLabel,data:e.map(function(e){return e.receipts})}],tooltip:{formatter:function(){var e=t[this.x];return e.weekday+" "+e.date+'<br /><b><a href="/play/'+e.play_id+'">'+e.play_title+"</a> (genre: "+e.play_genre+")"}}})}},{key:"render",value:function(){return(0,m.createElement)(g.Card,{className:(0,w.mdlclass)(12)},(0,m.createElement)(g.CardTitle,{style:_.STYLES.titleChart},"Recettes des pièces de "+this.props.seasonData.author.name+" sur la saison "+this.props.seasonLabel),(0,m.createElement)(g.CardText,{style:{margin:"auto"}},(0,m.createElement)("div",{id:"seasonchart"})))}}]),t}(m.Component);O.propTypes={seasonLabel:m.PropTypes.string,seasonData:m.PropTypes.object},(t.ASeasonPrimaryView=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s(t,e),f(t,[{key:"render",value:function(){if(this.props.loading)return(0,m.createElement)(g.Spinner,{style:{margin:"auto",display:"block"}});var e=this.props.mainentity;return(0,m.createElement)("section",null,(0,m.createElement)("h2",{style:{textAlign:"center"}},e.author.name+" - "+this.props.params.season),(0,m.createElement)("div",{id:"overview"},(0,m.createElement)(O,{seasonData:e,seasonLabel:this.props.params.season})))}}]),t}(m.Component)).propTypes={loading:m.PropTypes.bool,params:m.PropTypes.object,mainentity:m.PropTypes.object}},253:function(e,t,r){"use strict";function n(e){return{seasons:e.seasons}}function a(e){return{mainentity:e.mainentity,loading:e.loading}}function o(e){return{mainentity:e.mainentity,loading:e.loading}}Object.defineProperty(t,"__esModule",{value:!0}),t.ASeasonPrimaryView=t.SeasonPrimaryView=t.SeasonList=void 0;var i=r(120),s=r(403),l=function(e){return e&&e.__esModule?e:{default:e}}(s),c=r(119),u=r(1e3);t.SeasonList=(0,i.connect)(n)((0,l.default)(u.SeasonList,{fetcher:"fetchSeasons",success:c.actionTypes.SEASONS_FETCHED})),t.SeasonPrimaryView=(0,i.connect)(a)((0,l.default)(u.SeasonPrimaryView,{fetcher:"fetchSeason",success:c.actionTypes.SEASON_FETCHED})),t.ASeasonPrimaryView=(0,i.connect)(o)((0,l.default)(u.ASeasonPrimaryView,{fetcher:"fetchASeason",success:c.actionTypes.ASEASON_FETCHED}))},990:function(e,t,r){"use strict";function n(e){return a[e]||"#ccc"}Object.defineProperty(t,"__esModule",{value:!0}),t.genreColor=n;var a=(t.STYLES={titleChart:{backgroundColor:"#009687",color:"white",fontVariant:"small-caps",fontSize:"35px",fontWeight:"bold",justifyContent:"center"}},t.GENRE_COLORS={"comédie":"#ff7f0e","tragédie":"#1f77b4","comedie-ballet":"#ffbb78",drame:"#17becf",autre:"#e377c2",null:"#f7b6d2"})},993:function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function s(e){var t=(e.getMonth()+1)%12,r=0===t?e.getFullYear()+1:e.getFullYear();return new Date(r,t,1,12)}function l(e){return(e.getDay()+6)%7}function c(e,t){return Math.floor((Number(e)-Number(t))/864e5)}function u(e,t){function r(e){var t=["calendar-day"];return e.inrange||t.push("calendar-empty-cell"),e.free?t.push("calendar-free"):e.highrate&&t.push("calendar-highrate"),t.join(" ")}function n(e){var t=e.register;if(t){d3.select(this).style("cursor","pointer").style("stroke-width","2").style("stroke-opacity","0.8").style("stroke","black"),A.style("visibility","visible");var r=t.plays.map(function(e){return"<li>"+e.play_title+" / "+e.author_name+"</li>"}),n="\n"+(0,m.dateFormatter)(t.date)+"<br/>\nRecettes: "+t.receipts+" livres\n<ul>\n"+r+"\n</ul>\n";A.transition().duration(200).style("opacity",.9),A.html(n).style("left",d3.event.pageX+30+"px").style("top",d3.event.pageY+"px")}}function a(e){e.register&&(d3.select(this).style("cursor","default").style("stroke-width","0"),o())}function o(){for(A.transition().duration(500).style("opacity",0);A.firstChild;)A.removeChild(A.firstChild)}var u=new Date(e[0].date),p=new Date(e[e.length-1].date),d={};e.forEach(function(e){d[(0,m.dateFormatter)(new Date(e.date))]=e});var h=["lundi","mardi","mercredi","jeudi","vendredi","samedi","dimanche"],g=["janvier","février","mars","avril","mai","juin","juillet","août","septembre","octobre","novembre","décembre"],v=new Date(u.getFullYear(),u.getMonth(),1),b=s(p),E=d3.time.days(v,b).map(function(e){e=new Date(e);var t={date:e,weekday:l(e)};return e<u||e>p?(t.receipts=0,t.inrange=!1):(t.register=d[(0,m.dateFormatter)(e)],t.receipts=t.register?t.register.receipts:0,t.inrange=!0),t}),x=Math.min.apply(Math,i(e.map(function(e){return e.receipts}))),_=Math.max.apply(Math,i(e.map(function(e){return e.receipts}))),S=Math.floor(E.length/7)+2,w=20*S+100+10+40,T=d3.scale.linear().domain([x,_]).interpolate(d3.interpolateHcl).range([d3.rgb("#FFF3BB"),d3.rgb("#8e0000")]),C=d3.select(t).selectAll("svg").data(d3.range(u.getFullYear(),u.getFullYear()+1)).enter().append("svg").attr("width",w).attr("height",200),A=document.querySelector("#scalendar-tooltip");A=null===A?d3.select("body").append("div").attr("id","scalendar-tooltip").style("position","absolute").style("z-index","10").style("border","1px solid black").style("background-color","#fff").style("visibility","hidden"):d3.select(A),C.selectAll(".calendar-daylabel").data(h).enter().append("text").text(function(e){return e}).attr("x",120).attr("y",function(e,t){return 50+20*t}).attr("class","calendar-daylabel").style("text-anchor","end"),C.selectAll(".calendar-monthlabel").data(d3.time.months(u,p,3)).enter().append("text").text(function(e){return g[e.getMonth()]}).attr("x",function(e){return 130+20*Math.floor(c(e,v)/7)}).attr("y",20).attr("class","calendar-monthlabel");var P=C.append("g");P.selectAll(".calendar-day").data(E).enter().append("rect").attr("class",r).attr("width",20).attr("height",20).style("fill",function(e){return!e.free&&e.inrange&&e.register?T(e.receipts):"#fff"}).attr("x",function(e,t){return 130+20*Math.floor(t/7)}).attr("y",function(e,t){return 30+t%7*20}).on("mouseover",n).on("mouseout",a).on("click",function(e){o(),f.browserHistory.push((0,y.buildURL)("/register/"+(0,m.dateFormatter)(e.date)))})}Object.defineProperty(t,"__esModule",{value:!0}),t.SeasonCalendar=void 0;var p=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),d=r(1),f=r(251),m=r(403),y=r(101);(t.SeasonCalendar=function(e){function t(){return n(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),p(t,[{key:"render",value:function(){var e=this;return(0,d.createElement)("div",{style:{width:"80%",margin:"0 auto",textAlign:"center"}},(0,d.createElement)("h2",null,"Calendrier et recettes de la saison"),(0,d.createElement)("div",{id:"scalendar",key:"d"+Math.round(1e4*Math.random()),ref:function(){return u(e.props.registers,"#scalendar")}}))}}]),t}(d.Component)).propTypes={registers:d.PropTypes.array}},994:function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(){function e(){var e,c,p,f,m,y={},h=[],g=d3.range(o),v=[];for(r=[],n=[],e=0,f=-1;++f<o;){for(c=0,m=-1;++m<o;)c+=a[f][m];h.push(c),v.push(d3.range(o).reverse()),e+=c}for(i&&g.sort(function(e,t){return i(h[e],h[t])}),s&&v.forEach(function(e,t){e.sort(function(e,r){return s(a[t][e],a[t][r])})}),e=(u-d*o)/e,c=0,f=-1;++f<o;){for(p=c,m=-1;++m<o;){var b=g[f],E=v[b][m],x=a[b][E],_=c,S=c+=x*e;y[b+"-"+E]={index:b,subindex:E,startAngle:_,endAngle:S,value:x}}n[b]={index:b,startAngle:p,endAngle:c,value:(c-p)/e},c+=d}for(f=-1;++f<o;)for(m=f-1;++m<o;){var w=y[f+"-"+m],T=y[m+"-"+f];(w.value||T.value)&&r.push(w.value<T.value?{source:T,target:w}:{source:w,target:T})}l&&t()}function t(){r.sort(function(e,t){return l((e.source.value+e.target.value)/2,(t.source.value+t.target.value)/2)})}var r,n,a,o,i,s,l,c=Math.PI,u=2*c,p={},d=0;return p.matrix=function(e){return arguments.length?(o=(a=e)&&a.length,r=n=null,p):a},p.padding=function(e){return arguments.length?(d=e,r=n=null,p):d},p.sortGroups=function(e){return arguments.length?(i=e,r=n=null,p):i},p.sortSubgroups=function(e){return arguments.length?(s=e,r=null,p):s},p.sortChords=function(e){return arguments.length?(l=e,r&&t(),p):l},p.chords=function(){return r||e(),r},p.groups=function(){return n||e(),n},p}function s(){function e(e,t,r,n){var a=t.call(e,r,n),o=d.call(e,a,n),i=f.call(e,a,n)-g,s=m.call(e,a,n)-g;return{r:o,a0:[i],a1:[s],p0:[o*Math.cos(i),o*Math.sin(i)],p1:[o*Math.cos(s),o*Math.sin(s)]}}function t(e,t,r){var n=t[0]>=0?1:-1;return"A"+e+","+e+" 0 "+ +(r>h)+",1 "+(t[0]+n*y)+","+t[1]}function r(e){var t=e[0]>=0?1:-1;return"Q 0,0 "+(e[0]+t*y)+","+e[1]}function n(n,a){var o=e(this,u,n,a),i=e(this,p,n,a);return"M"+(o.p0[0]+y)+","+o.p0[1]+t(o.r,o.p1,o.a1-o.a0)+r(i.p0)+t(i.r,i.p1,i.a1-i.a0)+r(o.p0)+"Z"}function a(e){return e.radius}function o(e){return e.source}function i(e){return e.target}function s(e){return e.startAngle}function l(e){return e.endAngle}function c(e){return"function"==typeof e?e:function(){return e}}var u=o,p=i,d=a,f=s,m=l,y=0,h=Math.PI,g=h/2;return n.radius=function(e){return arguments.length?(d=c(e),n):d},n.pullOutSize=function(e){return arguments.length?(y=e,n):y},n.source=function(e){return arguments.length?(u=c(e),n):u},n.target=function(e){return arguments.length?(p=c(e),n):p},n.startAngle=function(e){return arguments.length?(f=c(e),n):f},n.endAngle=function(e){return arguments.length?(m=c(e),n):m},n}function l(e){function t(t,r){var n="gradient-"+t+"--"+r;if(void 0===b[n]){var a=E.append("linearGradient").attr("id",n).attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","0").attr("spreadMethod","reflect");a.append("stop").attr("offset","5%").attr("stop-color",e.colorscale(t)),a.append("stop").attr("offset","45%").attr("stop-color","#A3A3A3"),a.append("stop").attr("offset","55%").attr("stop-color","#A3A3A3"),a.append("stop").attr("offset","95%").attr("stop-color",e.colorscale(r))}return n}function r(e){return e.startAngle+x}function n(e){return e.endAngle+x}function a(t){return function(r,n){f.selectAll("path.chord").filter(function(t){return t.source.index!==n&&t.target.index!==n&&""!==e.names[t.source.index]}).transition("fadeOnArc").style("opacity",t)}}function o(e){var t=e;f.selectAll("path.chord").transition("fadeOnChord").style("opacity",function(e){return e.source.index===t.source.index&&e.target.index===t.target.index?h:g})}function l(e,t){e.each(function(){for(var e,r=d3.select(this),n=r.text().split(/\s+/).reverse(),a=[],o=0,i=parseFloat(r.attr("dy")),s=r.text(null).append("tspan").attr("x",0).attr("y",0).attr("dy",i+"em");e=n.pop();)a.push(e),s.text(a.join(" ")),s.node().getComputedTextLength()>t&&(a.pop(),s.text(a.join(" ")),a=[e],s=r.append("tspan").attr("x",0).attr("y",0).attr("dy",1.1*++o+i+"em").text(e))})}console.log("initChord",e);var c={top:20,right:40,bottom:20,left:40},u=1900-c.left-c.right,p=800-c.top-c.bottom,d=d3.select(e.domcontainer).append("svg").attr("width",u+c.left+c.right).attr("height",p+c.top+c.bottom),f=d.append("g").attr("class","chordWrapper").attr("transform","translate("+(u/2+c.left)+","+(p/2+c.top)+")"),m=Math.min(u,p)/2-100,y=.95*m,h=.7,g=.02,v=d.append("g").attr("class","chordTitleWrapper");v.append("text").attr("class","title left").style("font-size","16px").attr("x",u/2+c.left-m-0).attr("y",40).text("Première partie de soirée"),v.append("line").attr("class","titleLine left").attr("x1",.6*(u/2+c.left-m-0)).attr("x2",1.4*(u/2+c.left-m-0)).attr("y1",48).attr("y2",48),v.append("text").attr("class","title right").style("font-size","16px").attr("x",u/2+c.left+m+0).attr("y",40).text("Deuxième partie de soirée"),v.append("line").attr("class","titleLine right").attr("x1",.6*(u/2+c.left-m-0)+2*(m+0)).attr("x2",1.4*(u/2+c.left-m-0)+2*(m+0)).attr("y1",48).attr("y2",48);var b={},E=f.append("defs"),x=2*Math.PI*(e.emptyStroke/(e.total+e.emptyStroke))/4,_=i().padding(.02).sortChords(d3.descending).matrix(e.matrix),S=d3.svg.arc().innerRadius(y).outerRadius(m).startAngle(r).endAngle(n),w=s().radius(y).startAngle(r).endAngle(n).pullOutSize(50),T=f.selectAll("g.group").data(_.groups).enter().append("g").attr("class","group").on("mouseover",a(g)).on("mouseout",a(h));T.append("path").style("stroke",function(t,r){return""===e.names[r]?"none":e.colorscale(e.names[r])}).style("fill",function(t,r){return""===e.names[r]?"none":e.colorscale(e.names[r])}).style("pointer-events",function(t,r){return""===e.names[r]?"none":"auto"}).attr("d",S).attr("transform",function(e){return e.pullOutSize=50*(e.startAngle+.001>Math.PI?-1:1),"translate("+e.pullOutSize+",0)"}),T.append("text").each(function(e){e.angle=(e.startAngle+e.endAngle)/2+x}).attr("dy",".35em").attr("class","titles").style("font-size","10px").attr("text-anchor",function(e){return e.angle>Math.PI?"end":null}).attr("transform",function(e){var t=S.centroid(e);return"translate("+(t[0]+e.pullOutSize)+","+t[1]+")rotate("+(180*e.angle/Math.PI-90)+")translate(20,0)"+(e.angle>Math.PI?"rotate(180)":"")}).text(function(t,r){return e.names[r]}).call(l,100),f.selectAll("path.chord").data(_.chords).enter().append("path").attr("class","chord").style("stroke","none").style("fill",function(r){return"url(#"+t(e.names[r.target.index],e.names[r.source.index])+")"}).style("opacity",function(t){return""===e.names[t.source.index]?0:h}).style("pointer-events",function(t){return""===e.names[t.source.index]?"none":"auto"}).attr("d",w).on("mouseover",o).on("mouseout",a(h))}Object.defineProperty(t,"__esModule",{value:!0}),t.GenreChord=void 0;var c=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(1),p=r(990);(t.GenreChord=function(e){function t(){return n(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),c(t,[{key:"render",value:function(){var e=this;return null===this.props.chord?(0,u.createElement)("div",{},"no data yet (genre chord)"):(0,u.createElement)("div",{id:"gchord",key:"d"+Math.round(1e4*Math.random()),ref:function(t){return l(Object.assign({},e.props.chord,{domcontainer:"#gchord",colorscale:p.genreColor}))}})}}]),t}(u.Component)).propTypes={chord:u.PropTypes.object}}});